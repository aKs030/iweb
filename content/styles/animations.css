/**
 * Shared Animations
 * Common keyframe animations used across multiple components
 * @author Abdulkerim Sesli
 * @version 1.0.0
 */

/* ===== Fade In Animation ===== */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(var(--size-20));
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ===== Pulse Animation ===== */
@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

/* ===== Scroll-Driven Animations (CSS ScrollTimeline) ===== */
/* Progressive enhancement: only applied in supporting browsers */
@supports (animation-timeline: view()) {
  @keyframes scrollFadeIn {
    from {
      opacity: 0;
      transform: translateY(var(--size-40)) scale(0.97);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  /* Sections animate in when they enter the viewport */
  .section {
    animation: scrollFadeIn linear both;
    animation-timeline: view();
    animation-range: entry 0% entry 35%;
  }

  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    .section {
      animation: none;
    }
  }
}

/* =======================
   VIEW TRANSITIONS API
======================= */

/* In-Page View Transitions für Chat-Toggle.
   Cross-Document VT (navigation: auto) ist NICHT aktiviert —
   Unterseiten haben eigenes CSS/JS und brauchen volle Seitenlade. */

/* --- Default root: sofort, kein Effekt (verhindert Seiten-Flash) --- */
::view-transition-old(root),
::view-transition-new(root) {
  animation: none;
}

/* --- Loader-Overlay: Lift + Fade beim Ausblenden ---
   Der Loader hebt sich nach oben und verblasst —
   ein eleganter „Vorhang"-Effekt, der die App darunter freigibt. */
::view-transition-old(loader-overlay) {
  animation: 0.5s cubic-bezier(0.4, 0, 0, 1) both vt-loader-out;
  z-index: 999;
}

/* Kein ::view-transition-new(loader-overlay) nötig — Loader wird entfernt, nicht ersetzt */

/* --- Chat window: dramatische Slide-Up + Scale Animation ---
   Absichtlich stark anders als die CSS-Fallback-Transition (opacity+scale),
   damit der VT-Effekt klar sichtbar ist. */
::view-transition-old(robot-chat) {
  animation: 0.25s cubic-bezier(0.4, 0, 1, 1) both vt-chat-out;
}

::view-transition-new(robot-chat) {
  animation: 0.35s cubic-bezier(0, 0, 0.2, 1) both vt-chat-in;
}

/* Typed VT: Während Chat-Öffnen/Schließen den Root nicht animieren */
:root:active-view-transition-type(chat-open),
:root:active-view-transition-type(chat-close) {
  &::view-transition-old(root),
  &::view-transition-new(root) {
    animation: none;
  }
}

/* Typed VT: Beim Loader-Ausblenden sanften Root-Übergang zeigen */
:root:active-view-transition-type(loader-hide) {
  &::view-transition-new(root) {
    animation: 0.5s ease-out both vt-fade-in;
  }
}

/* Keyframes — Chat VT */
@keyframes vt-chat-out {
  from {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
  to {
    opacity: 0;
    transform: scale(0.4) translateY(40%);
  }
}

@keyframes vt-chat-in {
  from {
    opacity: 0;
    transform: scale(0.4) translateY(40%);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* Keyframes — Loader VT */
@keyframes vt-loader-out {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(-6%) scale(1.01);
  }
}

@keyframes vt-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@media (prefers-reduced-motion: reduce) {
  ::view-transition-old(robot-chat),
  ::view-transition-new(robot-chat),
  ::view-transition-old(loader-overlay),
  ::view-transition-new(root) {
    animation: none;
  }
}
