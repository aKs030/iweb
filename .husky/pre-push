#!/bin/sh
# Husky pre-push hook

# Run QA. If it fails, try to fix and notify the user.
npm run qa
if [ $? -ne 0 ]; then
  echo ""
  echo "‚ö†Ô∏è  QA check failed! Attempting to fix automatically..."
  echo ""

  # Try to fix
  if npm run qa:fix; then
    echo ""
    echo "‚úÖ Husky found and fixed code style issues for you."
    echo "üö® IMPORTANT: These changes are now in your workspace but NOT yet committed."
    echo "   Please run the following to finish your push:"
    echo ""
    echo "   git commit -am 'style: auto-fix' && git push"
    echo ""
  else
    echo "‚ùå Auto-fix failed. Please check the errors above."
  fi

  # Always exit with 1 if the initial QA failed, to prevent the push
  exit 1
fi
