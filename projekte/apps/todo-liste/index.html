<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>To-Do Liste | Abdulkerim Sesli</title>
    <meta name="description" content="Einfache To-Do App mit Filter und Statistik" />
    <script crossorigin src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>
    <link rel="stylesheet" href="../../../css/tailwind.css">
  </head>
  <body>
    <div id="root"></div>
    <script type="module">
      import htm from 'https://cdn.jsdelivr.net/npm/htm@3.1.1/dist/htm.module.js'
      const html = htm.bind(React.createElement)
      const {useState, useEffect} = React

      const LS_KEY = 'todo-list-items'

      function TodoApp() {
        const [items, setItems] = useState(() => JSON.parse(localStorage.getItem(LS_KEY) || '[]'))
        const [text, setText] = useState('')
        const [filter, setFilter] = useState('all') // all, open, done

        useEffect(() => {
          localStorage.setItem(LS_KEY, JSON.stringify(items))
        }, [items])

        const add = () => {
          if (!text.trim()) return
          setItems(prev => [{id: Date.now(), text: text.trim(), done: false}, ...prev])
          setText('')
        }

        const toggle = id => setItems(prev => prev.map(i => (i.id === id ? {...i, done: !i.done} : i)))
        const remove = id => setItems(prev => prev.filter(i => i.id !== id))
        const clearDone = () => setItems(prev => prev.filter(i => !i.done))

        const filtered = items.filter(i => (filter === 'all' ? true : filter === 'open' ? !i.done : i.done))
        const stats = {total: items.length, open: items.filter(i => !i.done).length, done: items.filter(i => i.done).length}

        return html`
          <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-6">
            <div className="w-full max-w-2xl bg-white/5 backdrop-blur-lg p-6 rounded-2xl border border-white/10">
              <div className="flex justify-between items-center mb-6">
                <h1 className="text-3xl font-bold text-white">To-Do Liste</h1>
                <a href="/projekte/" className="px-3 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg">← Zurück</a>
              </div>

              <div className="flex gap-2 mb-4">
                <input
                  value=${text}
                  onChange=${e => setText(e.target.value)}
                  onKeyPress=${e => e.key === 'Enter' && add()}
                  placeholder="Aufgabe hinzufügen..."
                  className="flex-1 px-4 py-3 rounded-lg bg-white/10 border border-white/10 text-white" />
                <button onClick=${add} className="px-4 py-3 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg">Hinzufügen</button>
              </div>

              <div className="flex gap-2 items-center mb-4 text-sm">
                <div className="flex gap-2">
                  <button
                    onClick=${() => setFilter('all')}
                    className="px-3 py-1 rounded ${filter === 'all' ? 'bg-white/10' : 'bg-transparent'} text-white">
                    Alle
                  </button>
                  <button
                    onClick=${() => setFilter('open')}
                    className="px-3 py-1 rounded ${filter === 'open' ? 'bg-white/10' : 'bg-transparent'} text-white">
                    Offen
                  </button>
                  <button
                    onClick=${() => setFilter('done')}
                    className="px-3 py-1 rounded ${filter === 'done' ? 'bg-white/10' : 'bg-transparent'} text-white">
                    Erledigt
                  </button>
                </div>
                <div className="ml-auto text-white/60">${stats.open} offen • ${stats.done} erledigt • ${stats.total} gesamt</div>
              </div>

              <div className="space-y-2 mb-4">
                ${filtered.length === 0
                  ? html`
                      <div className="text-white/50">Keine Aufgaben</div>
                    `
                  : filtered.map(
                      item => html`
                        <div key=${item.id} className="flex items-center gap-3 p-3 bg-white/5 rounded-lg border border-white/6">
                          <input type="checkbox" checked=${item.done} onChange=${() => toggle(item.id)} className="w-5 h-5" />
                          <div className="flex-1 ${item.done ? 'line-through text-white/40' : 'text-white'}">${item.text}</div>
                          <button onClick=${() => remove(item.id)} className="text-sm text-red-400 hover:text-red-300">Löschen</button>
                        </div>
                      `
                    )}
              </div>

              <div className="flex gap-2">
                <button onClick=${clearDone} className="px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg">
                  Erledigte löschen
                </button>
                <button onClick=${() => setItems([])} className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg">
                  Alles löschen
                </button>
              </div>

              <div className="mt-6 text-sm text-white/60">
                Speichert im LocalStorage. Filtere Aufgaben, markiere erledigt oder lösche sie.
              </div>
            </div>
          </div>
        `
      }

      const root = ReactDOM.createRoot(document.getElementById('root'))
      root.render(html`
        <${TodoApp} />
      `)
    </script>
  </body>
</html>
